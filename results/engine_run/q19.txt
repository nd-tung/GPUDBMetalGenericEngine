--- Running (Engine Host) ---
[Planner] Parsed aliases:
[Planner]   'revenue' -> 'sum(l_extendedprice* (1 - l_discount))'
[Planner]   'sum(l_extendedprice*(1-l_discount))' -> 'revenue'
[Planner] Traversing node: UNGROUPED_AGGREGATE
[Planner] Traversing: UNGROUPED_AGGREGATE
[Planner] Entering children traversal block. Name: ungrouped_aggregate Children: 1
[Planner] Traversing node: PROJECTION
[Planner] Traversing: PROJECTION
[Planner] Entering children traversal block. Name: projection Children: 1
[Planner] Traversing node: PROJECTION
[Planner] Traversing: PROJECTION
[Planner] Entering children traversal block. Name: projection Children: 1
[Planner] Traversing node: FILTER
[Planner] Traversing: FILTER
[Planner] Entering children traversal block. Name: filter Children: 1
[Planner] Traversing node: HASH_JOIN
[Planner] Traversing: HASH_JOIN
[Planner] [TraverseNode] Logic for JOIN: HASH_JOIN
[Planner] Checking RHS capture for Join HASH_JOIN
[Planner] Inspecting RHS node PROJECTION
[Planner] RHS is complex (tryCapture failed). Using Traversal-First Strategy.
[Planner] Traversing node: PROJECTION
[Planner] Traversing: PROJECTION
[Planner] Entering children traversal block. Name: projection Children: 1
[Planner] Traversing node: FILTER
[Planner] Traversing: FILTER
[Planner] Entering children traversal block. Name: filter Children: 1
[Planner] Traversing node: SEQ_SCAN 
[Planner] Traversing: SEQ_SCAN 
[Planner] Entering children traversal block. Name: seq_scan  Children: 0
[Planner] Parsing Projections for SEQ_SCAN 
[Planner] Proj: l_partkey
[Planner] Proj: l_quantity
[Planner] Proj: l_shipmode
[Planner] Proj: l_extendedprice
[Planner] Proj: l_discount
DEBUG: Scan table determined as: 'lineitem'
DEBUG: Pushing SCAN node for SEQ_SCAN . Table=lineitem
[Planner] Generating Scan: lineitem at index 0 Plan: 6132541832
[Planner] Node SEQ_SCAN  output projections: l_partkey, l_quantity, l_shipmode, l_extendedprice, l_discount, 
Expression: ((l_shipmode = 'AIR') OR (l_shipmode = 'AIR REG'))
[Planner] DEBUG FILTER CHILD PROJS: l_partkey, l_quantity, l_shipmode, l_extendedprice, l_discount, 
[Planner] Node FILTER output projections: l_partkey, l_quantity, l_shipmode, l_extendedprice, l_discount, 
[Planner] Parsing Projections for PROJECTION
[Planner] Proj: l_partkey
[Planner] Proj: l_quantity
[Planner] Proj: l_extendedprice
[Planner] Proj: l_discount
[Planner] Forcing keep of global column: l_shipmode
[Planner] Node PROJECTION output projections: l_partkey, l_quantity, l_extendedprice, l_discount, 
[Planner] Traversing node: SEQ_SCAN 
[Planner] Traversing: SEQ_SCAN 
[Planner] Entering children traversal block. Name: seq_scan  Children: 0
[Planner] Parsing Projections for SEQ_SCAN 
[Planner] Proj: p_partkey
[Planner] Proj: p_brand
[Planner] Proj: p_container
[Planner] Proj: p_size
DEBUG: Scan table determined as: 'part'
DEBUG: Pushing SCAN node for SEQ_SCAN . Table=part
[Planner] Generating Scan: part at index 4 Plan: 6132541832
[Planner] Node SEQ_SCAN  output projections: p_partkey, p_brand, p_container, p_size, 
[Planner] Creating JOIN 'HASH_JOIN'. CapturedRightTable: 'tmpl_join_3'
[Planner] Pre-resolved Condition: 'p_partkey = l_partkey'
[Planner] ChildProjs size: 8
  #0: p_partkey
  #1: p_brand
  #2: p_container
  #3: p_size
  #4: l_partkey
  #5: l_quantity
  #6: l_extendedprice
  #7: l_discount
[Planner] Resolved Condition: 'p_partkey = l_partkey'
DEBUG_JOIN_EMISSION: Node='HASH_JOIN' capturedRHS=true capturedRightTable='tmpl_join_3'
[Planner] Join Key Analysis: l => part, r => lineitem
[Planner] Captured RHS Table: tmpl_join_3
[Planner] RHS Tables: tmpl_join_3, 
[Planner] Checking matchesRHS: part
[Planner] Checking matchesRHS: lineitem
[Planner] Node HASH_JOIN output projections: p_partkey, p_brand, p_container, p_size, l_partkey, l_quantity, l_extendedprice, l_discount, 
Expression: (((l_quantity <= 11.00) AND (p_size <= 5) AND (p_brand = 'Brand#12') AND ((p_container = 'SM CASE') OR (p_container = 'SM BOX') OR (p_container = 'SM PACK') OR (p_container = 'SM PKG'))) OR ((l_quantity >= 10.00) AND (l_quantity <= 20.00) AND (p_size <= 10) AND (p_brand = 'Brand#23') AND ((p_container = 'MED BAG') OR (p_container = 'MED BOX') OR (p_container = 'MED PKG') OR (p_container = 'MED PACK'))) OR ((l_quantity >= 20.00) AND (l_quantity <= 30.00) AND (p_size <= 15) AND (p_brand = 'Brand#34') AND ((p_container = 'LG CASE') OR (p_container = 'LG BOX') OR (p_container = 'LG PACK') OR (p_container = 'LG PKG'))))
[Planner] DEBUG FILTER CHILD PROJS: p_partkey, p_brand, p_container, p_size, l_partkey, l_quantity, l_extendedprice, l_discount, 
DEBUG: Parsing string containing CASE: ''SM CASE''
DEBUG: Is Start? 0
DEBUG: Is End? 0
DEBUG: Parsing string containing CASE: ''LG CASE''
DEBUG: Is Start? 0
DEBUG: Is End? 0
[Planner] Node FILTER output projections: p_partkey, p_brand, p_container, p_size, l_partkey, l_quantity, l_extendedprice, l_discount, 
[Planner] Parsing Projections for PROJECTION
[Planner] Proj: l_partkey
[Planner] Proj: l_quantity
[Planner] Forcing keep of global column: l_discount
[Planner] Forcing keep of global column: l_extendedprice
[Planner] Forcing keep of global column: p_size
[Planner] Forcing keep of global column: p_container
[Planner] Forcing keep of global column: p_brand
[Planner] Forcing keep of global column: p_partkey
[Planner] Node PROJECTION output projections: l_partkey, l_quantity, 
[Planner] Parsing Projections for PROJECTION
[Planner] Proj: (l_extendedprice * (1.00 - l_discount))
[Planner] Forcing keep of global column: l_quantity
[Planner] Forcing keep of global column: l_partkey
[Planner] Node PROJECTION output projections: (l_extendedprice * (1.00 - l_discount)), 
[Planner] Processing aggregate: 'sum((l_extendedprice * (1.00 - l_discount)))'
[Planner] Node UNGROUPED_AGGREGATE output projections: sum((l_extendedprice * (1.00 - l_discount))), 
[Main] Using GpuExecutor generic executor.
[GPU] Device: Apple M3 Ultra
[GPU] Pre-compiled metallib not found, compiling shaders at runtime...
[GPU] Runtime Metal shader compilation succeeded (124 KB source).
GpuOps::gatherU32: Input or Indices buffer is NULL
---------------------------------------------------
======================RESULT=======================
---------------------------------------------------
Scalar sum((l_extendedprice * (1.00 - l_discount))): 3083843.25
---------------------------------------------------
Planning time: 21.45 ms
Data Load Time (Disk+Upload): 17798.66 ms
GPU kernels time: 54.96 ms
CPU postprocess time: 433.08 ms
Total Internal Pipeline time: 18286.70 ms
Total Host Execution time: 18287.41 ms
Total Wall time (Plan+Exec): 18308.86 ms
---------------------------------------------------
GPU Kernel Timing Summary:
─────────────────────────────────────────
  compact        :   17.102 ms (31.120%) [28 calls]
  filter         :   27.973 ms (50.900%) [28 calls]
  gather         :    4.575 ms (8.324%) [17 calls]
  hash_join_probe_u32:    5.307 ms (9.656%) [18 calls]
─────────────────────────────────────────
  TOTAL GPU TIME: 54.957 ms
  Kernel invocations: 91
