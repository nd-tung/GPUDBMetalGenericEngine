--- Running (Engine Host) ---
[Planner] Parsed aliases:
[Planner]   'volume' -> 'l_extendedprice * (1 - l_discount)'
[Planner]   'l_year' -> 'extract(year from l_shipdate)'
[Planner]   'extract(yearfroml_shipdate)' -> 'l_year'
[Planner]   'cust_nation' -> 'n2.n_name'
[Planner]   'sum(volume)' -> 'revenue'
[Planner]   'n2.n_name' -> 'cust_nation'
[Planner]   'supp_nation' -> 'n1.n_name'
[Planner]   'l_extendedprice*(1-l_discount)' -> 'volume'
[Planner]   'n1.n_name' -> 'supp_nation'
[Planner]   'revenue' -> 'sum(volume)'
[Planner] Traversing node: PROJECTION
[Planner] Traversing: PROJECTION
[Planner] Entering children traversal block. Name: projection Children: 1
[Planner] Traversing node: ORDER_BY
[Planner] Traversing: ORDER_BY
[Planner] Entering children traversal block. Name: order_by Children: 1
[Planner] Traversing node: PROJECTION
[Planner] Traversing: PROJECTION
[Planner] Entering children traversal block. Name: projection Children: 1
[Planner] Traversing node: PROJECTION
[Planner] Traversing: PROJECTION
[Planner] Entering children traversal block. Name: projection Children: 1
[Planner] Traversing node: HASH_GROUP_BY
[Planner] Traversing: HASH_GROUP_BY
[Planner] Entering children traversal block. Name: hash_group_by Children: 1
[Planner] Traversing node: PROJECTION
[Planner] Traversing: PROJECTION
[Planner] Entering children traversal block. Name: projection Children: 1
[Planner] Traversing node: PROJECTION
[Planner] Traversing: PROJECTION
[Planner] Entering children traversal block. Name: projection Children: 1
[Planner] Traversing node: PROJECTION
[Planner] Traversing: PROJECTION
[Planner] Entering children traversal block. Name: projection Children: 1
[Planner] Traversing node: FILTER
[Planner] Traversing: FILTER
[Planner] Entering children traversal block. Name: filter Children: 1
[Planner] Traversing node: HASH_JOIN
[Planner] Traversing: HASH_JOIN
[Planner] [TraverseNode] Logic for JOIN: HASH_JOIN
[Planner] Checking RHS capture for Join HASH_JOIN
[Planner] Inspecting RHS node HASH_JOIN
[Planner] RHS is complex (tryCapture failed). Using Traversal-First Strategy.
[Planner] Traversing node: HASH_JOIN
[Planner] Traversing: HASH_JOIN
[Planner] [TraverseNode] Logic for JOIN: HASH_JOIN
[Planner] Checking RHS capture for Join HASH_JOIN
[Planner] Inspecting RHS node FILTER
[Planner] processing filter node info
[Planner] captured filter: ((n_name = 'GERMANY') OR (n_name = 'FRANCE'))
[Planner] descending to child
[Planner] Inspecting RHS node SEQ_SCAN 
[Planner] Captured Table nation
[Planner] Traversing node: FILTER
[Planner] Traversing: FILTER
[Planner] Entering children traversal block. Name: filter Children: 1
[Planner] Traversing node: SEQ_SCAN 
[Planner] Traversing: SEQ_SCAN 
[Planner] Entering children traversal block. Name: seq_scan  Children: 0
[Planner] Parsing Projections for SEQ_SCAN 
[Planner] Proj: n_nationkey
[Planner] Proj: n_name
DEBUG: Scan table determined as: 'nation'
DEBUG: Pushing SCAN node for SEQ_SCAN . Table=nation
[Planner] Generating Scan: nation at index 0 Plan: 6091109776
[Planner] Node SEQ_SCAN  output projections: n_nationkey, n_name, 
Expression: ((n_name = 'GERMANY') OR (n_name = 'FRANCE'))
[Planner] DEBUG FILTER CHILD PROJS: n_nationkey, n_name, 
[Planner] Node FILTER output projections: n_nationkey, n_name, 
[Planner] Traversing node: SEQ_SCAN 
[Planner] Traversing: SEQ_SCAN 
[Planner] Entering children traversal block. Name: seq_scan  Children: 0
[Planner] Parsing Projections for SEQ_SCAN 
[Planner] Proj: c_custkey
[Planner] Proj: c_nationkey
DEBUG: Scan table determined as: 'customer'
DEBUG: Pushing SCAN node for SEQ_SCAN . Table=customer
[Planner] Generating Scan: customer at index 0 Plan: 6091139384
[Planner] Node SEQ_SCAN  output projections: c_custkey, c_nationkey, 
[Planner] Creating JOIN 'HASH_JOIN'. CapturedRightTable: 'nation'
[Planner] Pre-resolved Condition: 'c_nationkey = n_nationkey'
[Planner] ChildProjs size: 4
  #0: c_custkey
  #1: c_nationkey
  #2: n_nationkey
  #3: n_name
[Planner] Resolved Condition: 'c_nationkey = n_nationkey'
DEBUG_JOIN_EMISSION: Node='HASH_JOIN' capturedRHS=true capturedRightTable='nation'
[Planner] Join Key Analysis: l => customer, r => nation
[Planner] Captured RHS Table: nation
[Planner] RHS Tables: nation, 
[Planner] Checking matchesRHS: customer
[Planner] Checking matchesRHS: nation
[Planner] Node HASH_JOIN output projections: c_custkey, c_nationkey, n_nationkey, n_name, 
[Planner] Traversing node: HASH_JOIN
[Planner] Traversing: HASH_JOIN
[Planner] [TraverseNode] Logic for JOIN: HASH_JOIN
[Planner] Checking RHS capture for Join HASH_JOIN
[Planner] Inspecting RHS node HASH_JOIN
[Planner] RHS is complex (tryCapture failed). Using Traversal-First Strategy.
[Planner] Traversing node: HASH_JOIN
[Planner] Traversing: HASH_JOIN
[Planner] [TraverseNode] Logic for JOIN: HASH_JOIN
[Planner] Checking RHS capture for Join HASH_JOIN
[Planner] Inspecting RHS node HASH_JOIN
[Planner] RHS is complex (tryCapture failed). Using Traversal-First Strategy.
[Planner] Traversing node: HASH_JOIN
[Planner] Traversing: HASH_JOIN
[Planner] [TraverseNode] Logic for JOIN: HASH_JOIN
[Planner] Checking RHS capture for Join HASH_JOIN
[Planner] Inspecting RHS node FILTER
[Planner] processing filter node info
[Planner] captured filter: ((n_name = 'FRANCE') OR (n_name = 'GERMANY'))
[Planner] descending to child
[Planner] Inspecting RHS node SEQ_SCAN 
[Planner] Captured Table nation
[Planner] Traversing node: FILTER
[Planner] Traversing: FILTER
[Planner] Entering children traversal block. Name: filter Children: 1
[Planner] Traversing node: SEQ_SCAN 
[Planner] Traversing: SEQ_SCAN 
[Planner] Entering children traversal block. Name: seq_scan  Children: 0
[Planner] Parsing Projections for SEQ_SCAN 
[Planner] Proj: n_nationkey
[Planner] Proj: n_name
DEBUG: Scan table determined as: 'nation'
DEBUG: Pushing SCAN node for SEQ_SCAN . Table=nation
[Planner] Generating Scan: nation at index 0 Plan: 6091104432
[Planner] Node SEQ_SCAN  output projections: n_nationkey, n_name, 
Expression: ((n_name = 'FRANCE') OR (n_name = 'GERMANY'))
[Planner] DEBUG FILTER CHILD PROJS: n_nationkey, n_name, 
[Planner] Node FILTER output projections: n_nationkey, n_name, 
[Planner] Traversing node: SEQ_SCAN 
[Planner] Traversing: SEQ_SCAN 
[Planner] Entering children traversal block. Name: seq_scan  Children: 0
[Planner] Parsing Projections for SEQ_SCAN 
[Planner] Proj: s_suppkey
[Planner] Proj: s_nationkey
DEBUG: Scan table determined as: 'supplier'
DEBUG: Pushing SCAN node for SEQ_SCAN . Table=supplier
[Planner] Generating Scan: supplier at index 3 Plan: 6091139384
[Planner] Node SEQ_SCAN  output projections: s_suppkey, s_nationkey, 
[Planner] Creating JOIN 'HASH_JOIN'. CapturedRightTable: 'nation'
[Planner] Pre-resolved Condition: 's_nationkey = n_nationkey'
[Planner] ChildProjs size: 4
  #0: s_suppkey
  #1: s_nationkey
  #2: n_nationkey
  #3: n_name
[Planner] Resolved Condition: 's_nationkey = n_nationkey'
DEBUG_JOIN_EMISSION: Node='HASH_JOIN' capturedRHS=true capturedRightTable='nation'
[Planner] Join Key Analysis: l => supplier, r => nation
[Planner] Captured RHS Table: nation
[Planner] RHS Tables: nation, 
[Planner] Checking matchesRHS: supplier
[Planner] Checking matchesRHS: nation
[Planner] Node HASH_JOIN output projections: s_suppkey, s_nationkey, n_nationkey, n_name, 
[Planner] Traversing node: SEQ_SCAN 
[Planner] Traversing: SEQ_SCAN 
[Planner] Entering children traversal block. Name: seq_scan  Children: 0
[Planner] Parsing Projections for SEQ_SCAN 
[Planner] Proj: l_suppkey
[Planner] Proj: l_orderkey
[Planner] Proj: l_shipdate
[Planner] Proj: l_extendedprice
[Planner] Proj: l_discount
DEBUG: Scan table determined as: 'lineitem'
DEBUG: Pushing SCAN node for SEQ_SCAN . Table=lineitem
[Planner] Generating Scan: lineitem at index 6 Plan: 6091139384
[Planner] Node SEQ_SCAN  output projections: l_suppkey, l_orderkey, l_shipdate, l_extendedprice, l_discount, 
[Planner] Creating JOIN 'HASH_JOIN'. CapturedRightTable: 'tmpl_join_5'
[Planner] Pre-resolved Condition: 'l_suppkey = s_suppkey'
[Planner] ChildProjs size: 9
  #0: l_suppkey
  #1: l_orderkey
  #2: l_shipdate
  #3: l_extendedprice
  #4: l_discount
  #5: s_suppkey
  #6: s_nationkey
  #7: n_nationkey
  #8: n_name
[Planner] Resolved Condition: 'l_suppkey = s_suppkey'
DEBUG_JOIN_EMISSION: Node='HASH_JOIN' capturedRHS=true capturedRightTable='tmpl_join_5'
[Planner] Join Key Analysis: l => lineitem, r => supplier
[Planner] Captured RHS Table: tmpl_join_5
[Planner] RHS Tables: tmpl_join_5, 
[Planner] Checking matchesRHS: lineitem
[Planner] Checking matchesRHS: supplier
[Planner] Node HASH_JOIN output projections: l_suppkey, l_orderkey, l_shipdate, l_extendedprice, l_discount, s_suppkey, s_nationkey, n_nationkey, n_name, 
[Planner] Traversing node: SEQ_SCAN 
[Planner] Traversing: SEQ_SCAN 
[Planner] Entering children traversal block. Name: seq_scan  Children: 0
[Planner] Parsing Projections for SEQ_SCAN 
[Planner] Proj: o_orderkey
[Planner] Proj: o_custkey
DEBUG: Scan table determined as: 'orders'
DEBUG: Pushing SCAN node for SEQ_SCAN . Table=orders
[Planner] Generating Scan: orders at index 9 Plan: 6091139384
[Planner] Node SEQ_SCAN  output projections: o_orderkey, o_custkey, 
[Planner] Creating JOIN 'HASH_JOIN'. CapturedRightTable: 'tmpl_join_8'
[Planner] Pre-resolved Condition: 'o_orderkey = l_orderkey'
[Planner] ChildProjs size: 11
  #0: o_orderkey
  #1: o_custkey
  #2: l_suppkey
  #3: l_orderkey
  #4: l_shipdate
  #5: l_extendedprice
  #6: l_discount
  #7: s_suppkey
  #8: s_nationkey
  #9: n_nationkey
  #10: n_name
[Planner] Resolved Condition: 'o_orderkey = l_orderkey'
DEBUG_JOIN_EMISSION: Node='HASH_JOIN' capturedRHS=true capturedRightTable='tmpl_join_8'
[Planner] Join Key Analysis: l => orders, r => lineitem
[Planner] Captured RHS Table: tmpl_join_8
[Planner] RHS Tables: tmpl_join_8, 
[Planner] Checking matchesRHS: orders
[Planner] Checking matchesRHS: lineitem
[Planner] Node HASH_JOIN output projections: o_orderkey, o_custkey, l_suppkey, l_orderkey, l_shipdate, l_extendedprice, l_discount, s_suppkey, s_nationkey, n_nationkey, n_name, 
[Planner] Renamed duplicate column: n_nationkey -> n_nationkey_1
[Planner] Renamed duplicate column: n_name -> n_name_1
[Planner] Qualified mapping: n2.n_name -> n_name_1
[Planner] Creating JOIN 'HASH_JOIN'. CapturedRightTable: 'tmpl_join_2'
[Planner] Pre-resolved Condition: 'o_custkey = c_custkey'
[Planner] ChildProjs size: 15
  #0: o_orderkey
  #1: o_custkey
  #2: l_suppkey
  #3: l_orderkey
  #4: l_shipdate
  #5: l_extendedprice
  #6: l_discount
  #7: s_suppkey
  #8: s_nationkey
  #9: n_nationkey
  #10: n_name
  #11: c_custkey
  #12: c_nationkey
  #13: n_nationkey_1
  #14: n_name_1
[Planner] Resolved Condition: 'o_custkey = c_custkey'
DEBUG_JOIN_EMISSION: Node='HASH_JOIN' capturedRHS=true capturedRightTable='tmpl_join_2'
[Planner] Join Key Analysis: l => orders, r => customer
[Planner] Captured RHS Table: tmpl_join_2
[Planner] RHS Tables: tmpl_join_2, 
[Planner] Checking matchesRHS: orders
[Planner] Checking matchesRHS: customer
[Planner] Node HASH_JOIN output projections: o_orderkey, o_custkey, l_suppkey, l_orderkey, l_shipdate, l_extendedprice, l_discount, s_suppkey, s_nationkey, n_nationkey, n_name, c_custkey, c_nationkey, n_nationkey_1, n_name_1, 
Expression: (((n_name = 'FRANCE') AND (n_name = 'GERMANY')) OR ((n_name = 'GERMANY') AND (n_name = 'FRANCE')))
[Planner] DEBUG FILTER CHILD PROJS: o_orderkey, o_custkey, l_suppkey, l_orderkey, l_shipdate, l_extendedprice, l_discount, s_suppkey, s_nationkey, n_nationkey, n_name, c_custkey, c_nationkey, n_nationkey_1, n_name_1, 
[Planner] Node FILTER output projections: o_orderkey, o_custkey, l_suppkey, l_orderkey, l_shipdate, l_extendedprice, l_discount, s_suppkey, s_nationkey, n_nationkey, n_name, c_custkey, c_nationkey, n_nationkey_1, n_name_1, 
[Planner] Parsing Projections for PROJECTION
[Planner] Proj: supp_nation
[Planner] Proj: cust_nation
[Planner] Proj: l_year
[Planner] Proj: volume
[Planner] Projection: resolving alias 'supp_nation' -> 'n1.n_name'
[Planner] Projection: resolving alias 'cust_nation' -> 'n2.n_name'
[Planner] Projection: using qualified mapping 'n2.n_name' -> 'n_name_1'
[Planner] Projection: resolving alias 'l_year' -> 'extract(year from l_shipdate)'
[Planner] Projection: resolving alias 'volume' -> 'l_extendedprice * (1 - l_discount)'
[Planner] Forcing keep of global column: l_orderkey
[Planner] Forcing keep of global column: c_custkey
[Planner] Forcing keep of global column: n_nationkey
[Planner] Forcing keep of global column: n_name
[Planner] Forcing keep of global column: s_nationkey
[Planner] Forcing keep of global column: o_custkey
[Planner] Forcing keep of global column: l_discount
[Planner] Forcing keep of global column: l_extendedprice
[Planner] Forcing keep of global column: l_shipdate
[Planner] Forcing keep of global column: c_nationkey
[Planner] Forcing keep of global column: s_suppkey
[Planner] Forcing keep of global column: l_suppkey
[Planner] Forcing keep of global column: o_orderkey
[Planner] Node PROJECTION output projections: supp_nation, cust_nation, l_year, volume, 
[Planner] Parsing Projections for PROJECTION
[Planner] Proj: supp_nation
[Planner] Proj: cust_nation
[Planner] Proj: l_year
[Planner] Proj: volume
[Planner] Node PROJECTION output projections: supp_nation, cust_nation, l_year, volume, 
[Planner] Parsing Projections for PROJECTION
[Planner] Proj: supp_nation
[Planner] Proj: cust_nation
[Planner] Proj: l_year
[Planner] Proj: volume
[Planner] Node PROJECTION output projections: supp_nation, cust_nation, l_year, volume, 
[Planner] Parsing agg string: 'sum(#3)'
[Planner] Resolved agg: sum(volume)
[Planner] inputExpr 'volume' exists in child projections. Treating as Column.
[Planner] Looking up agg alias: 'sum(volume)'
[Planner] Found alias for agg: revenue
[Planner] Pushing spec with outputName='revenue'
[Planner] Node HASH_GROUP_BY output projections: supp_nation, cust_nation, l_year, revenue, 
[Planner] Parsing Projections for PROJECTION
[Planner] Proj: supp_nation
[Planner] Proj: cust_nation
[Planner] Proj: l_year
[Planner] Proj: revenue
[Planner] Node PROJECTION output projections: supp_nation, cust_nation, l_year, revenue, 
[Planner] Parsing Projections for PROJECTION
[Planner] Proj: supp_nation
[Planner] Proj: cust_nation
[Planner] Proj: l_year
[Planner] Proj: revenue
[Planner] Node PROJECTION output projections: supp_nation, cust_nation, l_year, revenue, 
[Planner] Node ORDER_BY output projections: supp_nation, cust_nation, l_year, revenue, 
[Planner] Parsing Projections for PROJECTION
[Planner] Proj: supp_nation
[Planner] Proj: cust_nation
[Planner] Proj: l_year
[Planner] Proj: revenue
[Planner] Node PROJECTION output projections: supp_nation, cust_nation, l_year, revenue, 
[Main] Using GpuExecutor generic executor.
[GPU] Device: Apple M3 Ultra
[GPU] Pre-compiled metallib not found, compiling shaders at runtime...
[GPU] Runtime Metal shader compilation succeeded (124 KB source).
---------------------------------------------------
======================RESULT=======================
---------------------------------------------------
l_year|revenue|supp_nation|cust_nation|
1995|54639724.00|FRANCE|GERMANY|
1996|54633084.00|FRANCE|GERMANY|
1995|52531744.00|GERMANY|FRANCE|
1996|52520564.00|GERMANY|FRANCE|
---------------------------------------------------
Planning time: 22.46 ms
Data Load Time (Disk+Upload): 11233.86 ms
GPU kernels time: 32.73 ms
CPU postprocess time: 56.73 ms
Total Internal Pipeline time: 11323.32 ms
Total Host Execution time: 11323.47 ms
Total Wall time (Plan+Exec): 11345.93 ms
---------------------------------------------------
GPU Kernel Timing Summary:
─────────────────────────────────────────
  compact        :    6.745 ms (20.611%) [11 calls]
  filter         :   12.916 ms (39.468%) [11 calls]
  gather         :    8.358 ms (25.540%) [13 calls]
  groupby        :    0.694 ms (2.121%) [3 calls]
  hash_join_probe_u32:    3.818 ms (11.665%) [7 calls]
  sort           :    0.195 ms (0.595%) [4 calls]
─────────────────────────────────────────
  TOTAL GPU TIME: 32.727 ms
  Kernel invocations: 49
