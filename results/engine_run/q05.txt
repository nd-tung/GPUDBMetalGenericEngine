--- Running (Engine Host) ---
[Planner] Parsed aliases:
[Planner]   'revenue' -> 'sum(l_extendedprice * (1 - l_discount))'
[Planner]   'sum(l_extendedprice*(1-l_discount))' -> 'revenue'
[Planner] Traversing node: PROJECTION
[Planner] Traversing: PROJECTION
[Planner] Entering children traversal block. Name: projection Children: 1
[Planner] Traversing node: ORDER_BY
[Planner] Traversing: ORDER_BY
[Planner] Entering children traversal block. Name: order_by Children: 1
[Planner] Traversing node: PROJECTION
[Planner] Traversing: PROJECTION
[Planner] Entering children traversal block. Name: projection Children: 1
[Planner] Traversing node: PROJECTION
[Planner] Traversing: PROJECTION
[Planner] Entering children traversal block. Name: projection Children: 1
[Planner] Traversing node: HASH_GROUP_BY
[Planner] Traversing: HASH_GROUP_BY
[Planner] Entering children traversal block. Name: hash_group_by Children: 1
[Planner] Traversing node: PROJECTION
[Planner] Traversing: PROJECTION
[Planner] Entering children traversal block. Name: projection Children: 1
[Planner] Traversing node: PROJECTION
[Planner] Traversing: PROJECTION
[Planner] Entering children traversal block. Name: projection Children: 1
[Planner] Traversing node: HASH_JOIN
[Planner] Traversing: HASH_JOIN
[Planner] [TraverseNode] Logic for JOIN: HASH_JOIN
[Planner] Checking RHS capture for Join HASH_JOIN
[Planner] Inspecting RHS node SEQ_SCAN 
[Planner] Captured Table supplier
[Planner] Traversing node: SEQ_SCAN 
[Planner] Traversing: SEQ_SCAN 
[Planner] Entering children traversal block. Name: seq_scan  Children: 0
[Planner] Parsing Projections for SEQ_SCAN 
[Planner] Proj: s_suppkey
[Planner] Proj: s_nationkey
DEBUG: Scan table determined as: 'supplier'
DEBUG: Pushing SCAN node for SEQ_SCAN . Table=supplier
[Planner] Generating Scan: supplier at index 0 Plan: 6131127520
[Planner] Node SEQ_SCAN  output projections: s_suppkey, s_nationkey, 
[Planner] Traversing node: HASH_JOIN
[Planner] Traversing: HASH_JOIN
[Planner] [TraverseNode] Logic for JOIN: HASH_JOIN
[Planner] Checking RHS capture for Join HASH_JOIN
[Planner] Inspecting RHS node HASH_JOIN
[Planner] RHS is complex (tryCapture failed). Using Traversal-First Strategy.
[Planner] Traversing node: HASH_JOIN
[Planner] Traversing: HASH_JOIN
[Planner] [TraverseNode] Logic for JOIN: HASH_JOIN
[Planner] Checking RHS capture for Join HASH_JOIN
[Planner] Inspecting RHS node HASH_JOIN
[Planner] RHS is complex (tryCapture failed). Using Traversal-First Strategy.
[Planner] Traversing node: HASH_JOIN
[Planner] Traversing: HASH_JOIN
[Planner] [TraverseNode] Logic for JOIN: HASH_JOIN
[Planner] Checking RHS capture for Join HASH_JOIN
[Planner] Inspecting RHS node HASH_JOIN
[Planner] RHS is complex (tryCapture failed). Using Traversal-First Strategy.
[Planner] Traversing node: HASH_JOIN
[Planner] Traversing: HASH_JOIN
[Planner] [TraverseNode] Logic for JOIN: HASH_JOIN
[Planner] Checking RHS capture for Join HASH_JOIN
[Planner] Inspecting RHS node SEQ_SCAN 
[Planner] Captured Table region
[Planner] Traversing node: SEQ_SCAN 
[Planner] Traversing: SEQ_SCAN 
[Planner] Entering children traversal block. Name: seq_scan  Children: 0
[Planner] Parsing Projections for SEQ_SCAN 
[Planner] Proj: r_regionkey
DEBUG: Scan table determined as: 'region'
DEBUG: Pushing SCAN node for SEQ_SCAN . Table=region
[Planner] Generating Scan: region at index 0 Plan: 6131116832
[Planner] Node SEQ_SCAN  output projections: r_regionkey, 
[Planner] Traversing node: SEQ_SCAN 
[Planner] Traversing: SEQ_SCAN 
[Planner] Entering children traversal block. Name: seq_scan  Children: 0
[Planner] Parsing Projections for SEQ_SCAN 
[Planner] Proj: n_nationkey
[Planner] Proj: n_regionkey
[Planner] Proj: n_name
DEBUG: Scan table determined as: 'nation'
DEBUG: Pushing SCAN node for SEQ_SCAN . Table=nation
[Planner] Generating Scan: nation at index 0 Plan: 6131149112
[Planner] Node SEQ_SCAN  output projections: n_nationkey, n_regionkey, n_name, 
[Planner] Creating JOIN 'HASH_JOIN'. CapturedRightTable: 'region'
[Planner] Pre-resolved Condition: 'n_regionkey = r_regionkey'
[Planner] ChildProjs size: 4
  #0: n_nationkey
  #1: n_regionkey
  #2: n_name
  #3: r_regionkey
[Planner] Resolved Condition: 'n_regionkey = r_regionkey'
DEBUG_JOIN_EMISSION: Node='HASH_JOIN' capturedRHS=true capturedRightTable='region'
[Planner] Join Key Analysis: l => nation, r => region
[Planner] Captured RHS Table: region
[Planner] RHS Tables: region, 
[Planner] Checking matchesRHS: nation
[Planner] Checking matchesRHS: region
[Planner] Node HASH_JOIN output projections: n_nationkey, n_regionkey, n_name, r_regionkey, 
[Planner] Traversing node: SEQ_SCAN 
[Planner] Traversing: SEQ_SCAN 
[Planner] Entering children traversal block. Name: seq_scan  Children: 0
[Planner] Parsing Projections for SEQ_SCAN 
[Planner] Proj: c_custkey
[Planner] Proj: c_nationkey
DEBUG: Scan table determined as: 'customer'
DEBUG: Pushing SCAN node for SEQ_SCAN . Table=customer
[Planner] Generating Scan: customer at index 3 Plan: 6131149112
[Planner] Node SEQ_SCAN  output projections: c_custkey, c_nationkey, 
[Planner] Creating JOIN 'HASH_JOIN'. CapturedRightTable: 'tmpl_join_2'
[Planner] Pre-resolved Condition: 'c_nationkey = n_nationkey'
[Planner] ChildProjs size: 6
  #0: c_custkey
  #1: c_nationkey
  #2: n_nationkey
  #3: n_regionkey
  #4: n_name
  #5: r_regionkey
[Planner] Resolved Condition: 'c_nationkey = n_nationkey'
DEBUG_JOIN_EMISSION: Node='HASH_JOIN' capturedRHS=true capturedRightTable='tmpl_join_2'
[Planner] Join Key Analysis: l => customer, r => nation
[Planner] Captured RHS Table: tmpl_join_2
[Planner] RHS Tables: tmpl_join_2, 
[Planner] Checking matchesRHS: customer
[Planner] Checking matchesRHS: nation
[Planner] Node HASH_JOIN output projections: c_custkey, c_nationkey, n_nationkey, n_regionkey, n_name, r_regionkey, 
[Planner] Traversing node: SEQ_SCAN 
[Planner] Traversing: SEQ_SCAN 
[Planner] Entering children traversal block. Name: seq_scan  Children: 0
[Planner] Parsing Projections for SEQ_SCAN 
[Planner] Proj: o_custkey
[Planner] Proj: o_orderkey
DEBUG: Scan table determined as: 'orders'
DEBUG: Pushing SCAN node for SEQ_SCAN . Table=orders
[Planner] Generating Scan: orders at index 6 Plan: 6131149112
[Planner] Node SEQ_SCAN  output projections: o_custkey, o_orderkey, 
[Planner] Creating JOIN 'HASH_JOIN'. CapturedRightTable: 'tmpl_join_5'
[Planner] Pre-resolved Condition: 'o_custkey = c_custkey'
[Planner] ChildProjs size: 8
  #0: o_custkey
  #1: o_orderkey
  #2: c_custkey
  #3: c_nationkey
  #4: n_nationkey
  #5: n_regionkey
  #6: n_name
  #7: r_regionkey
[Planner] Resolved Condition: 'o_custkey = c_custkey'
DEBUG_JOIN_EMISSION: Node='HASH_JOIN' capturedRHS=true capturedRightTable='tmpl_join_5'
[Planner] Join Key Analysis: l => orders, r => customer
[Planner] Captured RHS Table: tmpl_join_5
[Planner] RHS Tables: tmpl_join_5, 
[Planner] Checking matchesRHS: orders
[Planner] Checking matchesRHS: customer
[Planner] Node HASH_JOIN output projections: o_custkey, o_orderkey, c_custkey, c_nationkey, n_nationkey, n_regionkey, n_name, r_regionkey, 
[Planner] Traversing node: SEQ_SCAN 
[Planner] Traversing: SEQ_SCAN 
[Planner] Entering children traversal block. Name: seq_scan  Children: 0
[Planner] Parsing Projections for SEQ_SCAN 
[Planner] Proj: l_orderkey
[Planner] Proj: l_suppkey
[Planner] Proj: l_extendedprice
[Planner] Proj: l_discount
DEBUG: Scan table determined as: 'lineitem'
DEBUG: Pushing SCAN node for SEQ_SCAN . Table=lineitem
[Planner] Generating Scan: lineitem at index 9 Plan: 6131149112
[Planner] Node SEQ_SCAN  output projections: l_orderkey, l_suppkey, l_extendedprice, l_discount, 
[Planner] Creating JOIN 'HASH_JOIN'. CapturedRightTable: 'tmpl_join_8'
[Planner] Pre-resolved Condition: 'l_orderkey = o_orderkey'
[Planner] ChildProjs size: 12
  #0: l_orderkey
  #1: l_suppkey
  #2: l_extendedprice
  #3: l_discount
  #4: o_custkey
  #5: o_orderkey
  #6: c_custkey
  #7: c_nationkey
  #8: n_nationkey
  #9: n_regionkey
  #10: n_name
  #11: r_regionkey
[Planner] Resolved Condition: 'l_orderkey = o_orderkey'
DEBUG_JOIN_EMISSION: Node='HASH_JOIN' capturedRHS=true capturedRightTable='tmpl_join_8'
[Planner] Join Key Analysis: l => lineitem, r => orders
[Planner] Captured RHS Table: tmpl_join_8
[Planner] RHS Tables: tmpl_join_8, 
[Planner] Checking matchesRHS: lineitem
[Planner] Checking matchesRHS: orders
[Planner] Node HASH_JOIN output projections: l_orderkey, l_suppkey, l_extendedprice, l_discount, o_custkey, o_orderkey, c_custkey, c_nationkey, n_nationkey, n_regionkey, n_name, r_regionkey, 
[Planner] Creating JOIN 'HASH_JOIN'. CapturedRightTable: 'supplier'
[Planner] Pre-resolved Condition: 'c_nationkey = s_nationkey AND l_suppkey = s_suppkey'
[Planner] ChildProjs size: 14
  #0: l_orderkey
  #1: l_suppkey
  #2: l_extendedprice
  #3: l_discount
  #4: o_custkey
  #5: o_orderkey
  #6: c_custkey
  #7: c_nationkey
  #8: n_nationkey
  #9: n_regionkey
  #10: n_name
  #11: r_regionkey
  #12: s_suppkey
  #13: s_nationkey
[Planner] Resolved Condition: 'c_nationkey = s_nationkey AND l_suppkey = s_suppkey'
DEBUG_JOIN_EMISSION: Node='HASH_JOIN' capturedRHS=true capturedRightTable='supplier'
[Planner] Join Key Analysis: l => customer, r => supplier
[Planner] Captured RHS Table: supplier
[Planner] RHS Tables: supplier, 
[Planner] Checking matchesRHS: customer
[Planner] Checking matchesRHS: supplier
[Planner] Join Key Analysis: l => lineitem, r => supplier
[Planner] Captured RHS Table: supplier
[Planner] RHS Tables: supplier, 
[Planner] Checking matchesRHS: lineitem
[Planner] Checking matchesRHS: supplier
[Planner] Node HASH_JOIN output projections: l_orderkey, l_suppkey, l_extendedprice, l_discount, o_custkey, o_orderkey, c_custkey, c_nationkey, n_nationkey, n_regionkey, n_name, r_regionkey, s_suppkey, s_nationkey, 
[Planner] Parsing Projections for PROJECTION
[Planner] Proj: l_extendedprice
[Planner] Proj: l_orderkey
[Planner] Proj: l_suppkey
[Planner] Proj: l_discount
[Planner] Proj: o_custkey
[Planner] Forcing keep of global column: s_nationkey
[Planner] Forcing keep of global column: r_regionkey
[Planner] Forcing keep of global column: n_name
[Planner] Forcing keep of global column: n_regionkey
[Planner] Forcing keep of global column: n_nationkey
[Planner] Forcing keep of global column: o_orderkey
[Planner] Forcing keep of global column: s_suppkey
[Planner] Forcing keep of global column: c_nationkey
[Planner] Forcing keep of global column: c_custkey
[Planner] Node PROJECTION output projections: l_extendedprice, l_orderkey, l_suppkey, l_discount, o_custkey, 
[Planner] Parsing Projections for PROJECTION
[Planner] Proj: n_name
[Planner] Proj: (l_extendedprice * (1.00 - l_discount))
[Planner] Forcing keep of global column: l_extendedprice
[Planner] Forcing keep of global column: l_discount
[Planner] Forcing keep of global column: o_custkey
[Planner] Forcing keep of global column: l_suppkey
[Planner] Forcing keep of global column: l_orderkey
[Planner] Node PROJECTION output projections: n_name, (l_extendedprice * (1.00 - l_discount)), 
[Planner] Parsing agg string: 'sum(#1)'
[Planner] Resolved agg: sum((l_extendedprice * (1.00 - l_discount)))
[Planner] inputExpr '(l_extendedprice * (1.00 - l_discount))' exists in child projections. Treating as Column.
[Planner] Looking up agg alias: 'sum((l_extendedprice*(1-l_discount)))'
[Planner] Found alias with reduced parens: 'sum(l_extendedprice*(1-l_discount))'
[Planner] Found alias for agg: revenue
[Planner] Pushing spec with outputName='revenue'
[Planner] Node HASH_GROUP_BY output projections: n_name, revenue, 
[Planner] Parsing Projections for PROJECTION
[Planner] Proj: n_name
[Planner] Proj: revenue
[Planner] Node PROJECTION output projections: n_name, revenue, 
[Planner] Parsing Projections for PROJECTION
[Planner] Proj: n_name
[Planner] Proj: revenue
[Planner] Node PROJECTION output projections: n_name, revenue, 
[Planner] ORDER BY looking up alias: 'sum((l_extendedprice*(1-l_discount)))'
[Planner] Node ORDER_BY output projections: n_name, revenue, 
[Planner] Parsing Projections for PROJECTION
[Planner] Proj: n_name
[Planner] Proj: revenue
[Planner] Node PROJECTION output projections: n_name, revenue, 
[Main] Using GpuExecutor generic executor.
[GPU] Device: Apple M3 Ultra
[GPU] Pre-compiled metallib not found, compiling shaders at runtime...
[GPU] Runtime Metal shader compilation succeeded (124 KB source).
---------------------------------------------------
======================RESULT=======================
---------------------------------------------------
revenue|n_name|
55502020.00|INDONESIA|
55295076.00|VIETNAM|
53724508.00|CHINA|
52035504.00|INDIA|
45410172.00|JAPAN|
---------------------------------------------------
Planning time: 20.37 ms
Data Load Time (Disk+Upload): 9338.33 ms
GPU kernels time: 22.92 ms
CPU postprocess time: 32.07 ms
Total Internal Pipeline time: 9393.32 ms
Total Host Execution time: 9393.47 ms
Total Wall time (Plan+Exec): 9413.85 ms
---------------------------------------------------
GPU Kernel Timing Summary:
─────────────────────────────────────────
  compact        :    3.076 ms (13.421%) [4 calls]
  filter         :    9.457 ms (41.257%) [4 calls]
  gather         :    6.204 ms (27.065%) [7 calls]
  groupby        :    0.566 ms (2.470%) [3 calls]
  hash_join_probe_u32:    3.210 ms (14.003%) [4 calls]
  hash_join_probe_u64:    0.247 ms (1.078%) [1 calls]
  sort           :    0.162 ms (0.706%) [2 calls]
─────────────────────────────────────────
  TOTAL GPU TIME: 22.923 ms
  Kernel invocations: 25
