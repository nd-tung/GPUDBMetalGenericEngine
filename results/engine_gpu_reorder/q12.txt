--- Running (Engine Host) ---
[Planner] Parsed aliases:
[Planner]   'high_line_count' -> 'sum(case
        when o_orderpriority = '1-URGENT'
            or o_orderpriority = '2-HIGH'
            then 1
        else 0
    end)'
[Planner]   'low_line_count' -> 'sum(case
        when o_orderpriority <> '1-URGENT'
            and o_orderpriority <> '2-HIGH'
            then 1
        else 0
    end)'
[Planner]   'sum(casewheno_orderpriority!='1-urgent'ando_orderpriority!='2-high'then1else0end)' -> 'low_line_count'
[Planner]   'sum(casewheno_orderpriority='1-urgent'oro_orderpriority='2-high'then1else0end)' -> 'high_line_count'
[Planner] Traversing node: PROJECTION
[Planner] Traversing: PROJECTION
[Planner] Entering children traversal block. Name: projection Children: 1
[Planner] Traversing node: ORDER_BY
[Planner] Traversing: ORDER_BY
[Planner] Entering children traversal block. Name: order_by Children: 1
[Planner] Traversing node: PROJECTION
[Planner] Traversing: PROJECTION
[Planner] Entering children traversal block. Name: projection Children: 1
[Planner] Traversing node: PROJECTION
[Planner] Traversing: PROJECTION
[Planner] Entering children traversal block. Name: projection Children: 1
[Planner] Traversing node: HASH_GROUP_BY
[Planner] Traversing: HASH_GROUP_BY
[Planner] Entering children traversal block. Name: hash_group_by Children: 1
[Planner] Traversing node: PROJECTION
[Planner] Traversing: PROJECTION
[Planner] Entering children traversal block. Name: projection Children: 1
[Planner] Traversing node: PROJECTION
[Planner] Traversing: PROJECTION
[Planner] Entering children traversal block. Name: projection Children: 1
[Planner] Traversing node: HASH_JOIN
[Planner] Traversing: HASH_JOIN
[Planner] [TraverseNode] Logic for JOIN: HASH_JOIN
[Planner] Checking RHS capture for Join HASH_JOIN
[Planner] Inspecting RHS node PROJECTION
[Planner] RHS is complex (tryCapture failed). Using Traversal-First Strategy.
[Planner] Traversing node: PROJECTION
[Planner] Traversing: PROJECTION
[Planner] Entering children traversal block. Name: projection Children: 1
[Planner] Traversing node: FILTER
[Planner] Traversing: FILTER
[Planner] Entering children traversal block. Name: filter Children: 1
[Planner] Traversing node: SEQ_SCAN 
[Planner] Traversing: SEQ_SCAN 
[Planner] Entering children traversal block. Name: seq_scan  Children: 0
[Planner] Parsing Projections for SEQ_SCAN 
[Planner] Proj: l_orderkey
[Planner] Proj: l_shipmode
[Planner] Proj: l_commitdate
[Planner] Proj: l_receiptdate
[Planner] Proj: l_shipdate
DEBUG: Scan table determined as: 'lineitem'
DEBUG: Pushing SCAN node for SEQ_SCAN . Table=lineitem
[Planner] Generating Scan: lineitem at index 0 Plan: 6160754968
[Planner] Node SEQ_SCAN  output projections: l_orderkey, l_shipmode, l_commitdate, l_receiptdate, l_shipdate, 
Expression: ((l_commitdate < l_receiptdate) AND (l_shipdate < l_commitdate) AND ((l_shipmode = 'MAIL') OR (l_shipmode = 'SHIP')))
[Planner] DEBUG FILTER CHILD PROJS: l_orderkey, l_shipmode, l_commitdate, l_receiptdate, l_shipdate, 
[Planner] Node FILTER output projections: l_orderkey, l_shipmode, l_commitdate, l_receiptdate, l_shipdate, 
[Planner] Parsing Projections for PROJECTION
[Planner] Proj: l_orderkey
[Planner] Proj: l_shipmode
[Planner] Forcing keep of global column: l_commitdate
[Planner] Forcing keep of global column: l_shipdate
[Planner] Forcing keep of global column: l_receiptdate
[Planner] Node PROJECTION output projections: l_orderkey, l_shipmode, 
[Planner] Traversing node: SEQ_SCAN 
[Planner] Traversing: SEQ_SCAN 
[Planner] Entering children traversal block. Name: seq_scan  Children: 0
[Planner] Parsing Projections for SEQ_SCAN 
[Planner] Proj: o_orderkey
[Planner] Proj: o_orderpriority
DEBUG: Scan table determined as: 'orders'
DEBUG: Pushing SCAN node for SEQ_SCAN . Table=orders
[Planner] Generating Scan: orders at index 4 Plan: 6160754968
[Planner] Node SEQ_SCAN  output projections: o_orderkey, o_orderpriority, 
[Planner] Creating JOIN 'HASH_JOIN'. CapturedRightTable: 'tmpl_join_3'
[Planner] Pre-resolved Condition: 'o_orderkey = l_orderkey'
[Planner] ChildProjs size: 4
  #0: o_orderkey
  #1: o_orderpriority
  #2: l_orderkey
  #3: l_shipmode
[Planner] Resolved Condition: 'o_orderkey = l_orderkey'
DEBUG_JOIN_EMISSION: Node='HASH_JOIN' capturedRHS=true capturedRightTable='tmpl_join_3'
[Planner] Join Key Analysis: l => orders, r => lineitem
[Planner] Captured RHS Table: tmpl_join_3
[Planner] RHS Tables: tmpl_join_3, 
[Planner] Checking matchesRHS: orders
[Planner] Checking matchesRHS: lineitem
[Planner] Node HASH_JOIN output projections: o_orderkey, o_orderpriority, l_orderkey, l_shipmode, 
[Planner] Parsing Projections for PROJECTION
[Planner] Proj: o_orderkey
[Planner] Proj: o_orderpriority
[Planner] Forcing keep of global column: l_orderkey
[Planner] Forcing keep of global column: l_shipmode
[Planner] Node PROJECTION output projections: o_orderkey, o_orderpriority, 
[Planner] Parsing Projections for PROJECTION
[Planner] Proj: l_shipmode
[Planner] Proj: CASE  WHEN (((o_orderpriority = '1-URGENT') OR (o_orderpriority = '2-HIGH'))) THEN (1) ELSE 0 END
[Planner] Proj: CASE  WHEN (((o_orderpriority != '1-URGENT') AND (o_orderpriority != '2-HIGH'))) THEN (1) ELSE 0 END
[Planner] Forcing keep of global column: o_orderpriority
[Planner] Forcing keep of global column: o_orderkey
[Planner] Node PROJECTION output projections: l_shipmode, CASE  WHEN (((o_orderpriority = '1-URGENT') OR (o_orderpriority = '2-HIGH'))) THEN (1) ELSE 0 END, CASE  WHEN (((o_orderpriority != '1-URGENT') AND (o_orderpriority != '2-HIGH'))) THEN (1) ELSE 0 END, 
[Planner] Parsing agg string: 'sum(#1)'
[Planner] Resolved agg: sum(CASE  WHEN (((o_orderpriority = '1-URGENT') OR (o_orderpriority = '2-HIGH'))) THEN (1) ELSE 0 END)
[Planner] inputExpr 'CASE  WHEN (((o_orderpriority = '1-URGENT') OR (o_orderpriority = '2-HIGH'))) THEN (1) ELSE 0 END' exists in child projections. Treating as Column.
[Planner] Looking up agg alias: 'sum(casewhen(((o_orderpriority='1-urgent')or(o_orderpriority='2-high')))then(1)else0end)'
[Planner] Found alias via stripped comparison: 'high_line_count'
[Planner] Found alias for agg: high_line_count
[Planner] Pushing spec with outputName='high_line_count'
[Planner] Parsing agg string: 'sum(#2)'
[Planner] Resolved agg: sum(CASE  WHEN (((o_orderpriority != '1-URGENT') AND (o_orderpriority != '2-HIGH'))) THEN (1) ELSE 0 END)
[Planner] inputExpr 'CASE  WHEN (((o_orderpriority != '1-URGENT') AND (o_orderpriority != '2-HIGH'))) THEN (1) ELSE 0 END' exists in child projections. Treating as Column.
[Planner] Looking up agg alias: 'sum(casewhen(((o_orderpriority!='1-urgent')and(o_orderpriority!='2-high')))then(1)else0end)'
[Planner] Found alias via stripped comparison: 'low_line_count'
[Planner] Found alias for agg: low_line_count
[Planner] Pushing spec with outputName='low_line_count'
[Planner] Node HASH_GROUP_BY output projections: l_shipmode, high_line_count, low_line_count, 
[Planner] Parsing Projections for PROJECTION
[Planner] Proj: l_shipmode
[Planner] Proj: high_line_count
[Planner] Proj: low_line_count
[Planner] Node PROJECTION output projections: l_shipmode, high_line_count, low_line_count, 
[Planner] Parsing Projections for PROJECTION
[Planner] Proj: l_shipmode
[Planner] Proj: high_line_count
[Planner] Proj: low_line_count
[Planner] Node PROJECTION output projections: l_shipmode, high_line_count, low_line_count, 
[Planner] Node ORDER_BY output projections: l_shipmode, high_line_count, low_line_count, 
[Planner] Parsing Projections for PROJECTION
[Planner] Proj: l_shipmode
[Planner] Proj: high_line_count
[Planner] Proj: low_line_count
[Planner] Node PROJECTION output projections: l_shipmode, high_line_count, low_line_count, 
[Main] Using GpuExecutor generic executor.
[GPU] Device: Apple M3 Ultra
[GPU] Pre-compiled metallib not found, compiling shaders at runtime...
[GPU] Runtime Metal shader compilation succeeded (123 KB source).
---------------------------------------------------
======================RESULT=======================
---------------------------------------------------
high_line_count|low_line_count|l_shipmode|
6202.00|9324.00|MAIL|
6200.00|9262.00|SHIP|
---------------------------------------------------
Planning time: 20.63 ms
Data Load Time (Disk+Upload): 15099.97 ms
GPU kernels time: 32.35 ms
CPU postprocess time: 279.61 ms
Total Internal Pipeline time: 15411.94 ms
Total Host Execution time: 15412.54 ms
Total Wall time (Plan+Exec): 15433.17 ms
---------------------------------------------------
GPU Kernel Timing Summary:
─────────────────────────────────────────
  compact        :    7.564 ms (23.377%) [12 calls]
  filter         :   18.115 ms (55.990%) [12 calls]
  gather         :    3.067 ms (9.479%) [8 calls]
  groupby        :    1.258 ms (3.889%) [1 calls]
  hash_join_probe_u32:    2.141 ms (6.618%) [3 calls]
  sort           :    0.209 ms (0.647%) [2 calls]
─────────────────────────────────────────
  TOTAL GPU TIME: 32.354 ms
  Kernel invocations: 38
Detailed Kernel Timings:
─────────────────────────────────────────────────────────────────
Kernel                           Time (ms)       Elements           ME/s
─────────────────────────────────────────────────────────────────
ops::filter_string_eq                8.443        6001215        710.760
ops::compact_indices                 1.603        6001215       3743.642
ops::filter_string_eq                1.844        6001215       3255.189
ops::compact_indices                 1.113        6001215       5391.322
ops::filter_lt_u32_indexed           2.192        1715437        782.441
ops::compact_indices_indexed         0.483        1715437       3550.093
ops::filter_ge_u32_indexed           0.478         736521       1539.229
ops::compact_indices_indexed         0.327         736521       2250.637
ops::filter_lt_u32_indexed           0.503         271043        538.943
ops::compact_indices_indexed         0.295         271043        919.697
ops::filter_lt_u32_indexed           0.409         252729        617.228
ops::compact_indices_indexed         0.259         252729        977.361
ops::gather_col_u32                  0.788         252729        320.892
ops::gather_col_u32                  0.274         252729        921.249
ops::gather_col_u32                  0.240         164472        684.823
ops::gather_col_u32                  0.252         164472        652.020
ops::gather_col_u32                  0.249         164472        659.648
ops::gather_col_u32                  0.221          30988        140.349
ops::filter_string_eq                1.684        6001215       3563.667
ops::compact_indices                 1.411        6001215       4253.291
hash_join_probe_write_multi          0.443         857401       1934.172
ops::gather_col_u32                  0.224          15526         69.403
ops::filter_string_eq                1.645        6001215       3649.264
ops::compact_indices                 1.198        6001215       5011.277
hash_join_probe_write_multi          1.179         858036        727.972
ops::gather_col_u32                  0.819          15462         18.885
hash_join_probe_write_multi          0.519        1500000       2889.016
ops::filter_string_eq                0.242          30988        128.248
ops::compact_indices                 0.227          30988        136.536
ops::filter_string_eq                0.246          30988        125.861
ops::compact_indices                 0.219          30988        141.256
ops::filter_ne_u32                   0.211          30988        147.008
ops::compact_indices                 0.215          30988        144.242
ops::filter_ne_u32_indexed           0.218          24705        113.391
ops::compact_indices_indexed         0.214          24705        115.421
ops::groupby_agg_multi_key_ty        1.258          30988         24.630
block_sort_kv_u64                    0.000              2          0.000
orderby_gpu_gather                   0.209              4          0.019
─────────────────────────────────────────────────────────────────
TOTAL: 32.354 ms
