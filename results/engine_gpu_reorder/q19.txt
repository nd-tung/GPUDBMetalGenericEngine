--- Running (Engine Host) ---
[Planner] Parsed aliases:
[Planner]   'revenue' -> 'sum(l_extendedprice* (1 - l_discount))'
[Planner]   'sum(l_extendedprice*(1-l_discount))' -> 'revenue'
[Planner] Traversing node: UNGROUPED_AGGREGATE
[Planner] Traversing: UNGROUPED_AGGREGATE
[Planner] Entering children traversal block. Name: ungrouped_aggregate Children: 1
[Planner] Traversing node: PROJECTION
[Planner] Traversing: PROJECTION
[Planner] Entering children traversal block. Name: projection Children: 1
[Planner] Traversing node: PROJECTION
[Planner] Traversing: PROJECTION
[Planner] Entering children traversal block. Name: projection Children: 1
[Planner] Traversing node: FILTER
[Planner] Traversing: FILTER
[Planner] Entering children traversal block. Name: filter Children: 1
[Planner] Traversing node: HASH_JOIN
[Planner] Traversing: HASH_JOIN
[Planner] [TraverseNode] Logic for JOIN: HASH_JOIN
[Planner] Checking RHS capture for Join HASH_JOIN
[Planner] Inspecting RHS node PROJECTION
[Planner] RHS is complex (tryCapture failed). Using Traversal-First Strategy.
[Planner] Traversing node: PROJECTION
[Planner] Traversing: PROJECTION
[Planner] Entering children traversal block. Name: projection Children: 1
[Planner] Traversing node: FILTER
[Planner] Traversing: FILTER
[Planner] Entering children traversal block. Name: filter Children: 1
[Planner] Traversing node: SEQ_SCAN 
[Planner] Traversing: SEQ_SCAN 
[Planner] Entering children traversal block. Name: seq_scan  Children: 0
[Planner] Parsing Projections for SEQ_SCAN 
[Planner] Proj: l_partkey
[Planner] Proj: l_quantity
[Planner] Proj: l_shipmode
[Planner] Proj: l_extendedprice
[Planner] Proj: l_discount
DEBUG: Scan table determined as: 'lineitem'
DEBUG: Pushing SCAN node for SEQ_SCAN . Table=lineitem
[Planner] Generating Scan: lineitem at index 0 Plan: 6122989848
[Planner] Node SEQ_SCAN  output projections: l_partkey, l_quantity, l_shipmode, l_extendedprice, l_discount, 
Expression: ((l_shipmode = 'AIR') OR (l_shipmode = 'AIR REG'))
[Planner] DEBUG FILTER CHILD PROJS: l_partkey, l_quantity, l_shipmode, l_extendedprice, l_discount, 
[Planner] Node FILTER output projections: l_partkey, l_quantity, l_shipmode, l_extendedprice, l_discount, 
[Planner] Parsing Projections for PROJECTION
[Planner] Proj: l_partkey
[Planner] Proj: l_quantity
[Planner] Proj: l_extendedprice
[Planner] Proj: l_discount
[Planner] Forcing keep of global column: l_shipmode
[Planner] Node PROJECTION output projections: l_partkey, l_quantity, l_extendedprice, l_discount, 
[Planner] Traversing node: SEQ_SCAN 
[Planner] Traversing: SEQ_SCAN 
[Planner] Entering children traversal block. Name: seq_scan  Children: 0
[Planner] Parsing Projections for SEQ_SCAN 
[Planner] Proj: p_partkey
[Planner] Proj: p_brand
[Planner] Proj: p_container
[Planner] Proj: p_size
DEBUG: Scan table determined as: 'part'
DEBUG: Pushing SCAN node for SEQ_SCAN . Table=part
[Planner] Generating Scan: part at index 4 Plan: 6122989848
[Planner] Node SEQ_SCAN  output projections: p_partkey, p_brand, p_container, p_size, 
[Planner] Creating JOIN 'HASH_JOIN'. CapturedRightTable: 'tmpl_join_3'
[Planner] Pre-resolved Condition: 'p_partkey = l_partkey'
[Planner] ChildProjs size: 8
  #0: p_partkey
  #1: p_brand
  #2: p_container
  #3: p_size
  #4: l_partkey
  #5: l_quantity
  #6: l_extendedprice
  #7: l_discount
[Planner] Resolved Condition: 'p_partkey = l_partkey'
DEBUG_JOIN_EMISSION: Node='HASH_JOIN' capturedRHS=true capturedRightTable='tmpl_join_3'
[Planner] Join Key Analysis: l => part, r => lineitem
[Planner] Captured RHS Table: tmpl_join_3
[Planner] RHS Tables: tmpl_join_3, 
[Planner] Checking matchesRHS: part
[Planner] Checking matchesRHS: lineitem
[Planner] Node HASH_JOIN output projections: p_partkey, p_brand, p_container, p_size, l_partkey, l_quantity, l_extendedprice, l_discount, 
Expression: (((l_quantity <= 11.00) AND (p_size <= 5) AND (p_brand = 'Brand#12') AND ((p_container = 'SM CASE') OR (p_container = 'SM BOX') OR (p_container = 'SM PACK') OR (p_container = 'SM PKG'))) OR ((l_quantity >= 10.00) AND (l_quantity <= 20.00) AND (p_size <= 10) AND (p_brand = 'Brand#23') AND ((p_container = 'MED BAG') OR (p_container = 'MED BOX') OR (p_container = 'MED PKG') OR (p_container = 'MED PACK'))) OR ((l_quantity >= 20.00) AND (l_quantity <= 30.00) AND (p_size <= 15) AND (p_brand = 'Brand#34') AND ((p_container = 'LG CASE') OR (p_container = 'LG BOX') OR (p_container = 'LG PACK') OR (p_container = 'LG PKG'))))
[Planner] DEBUG FILTER CHILD PROJS: p_partkey, p_brand, p_container, p_size, l_partkey, l_quantity, l_extendedprice, l_discount, 
DEBUG: Parsing string containing CASE: ''SM CASE''
DEBUG: Is Start? 0
DEBUG: Is End? 0
DEBUG: Parsing string containing CASE: ''LG CASE''
DEBUG: Is Start? 0
DEBUG: Is End? 0
[Planner] Node FILTER output projections: p_partkey, p_brand, p_container, p_size, l_partkey, l_quantity, l_extendedprice, l_discount, 
[Planner] Parsing Projections for PROJECTION
[Planner] Proj: l_partkey
[Planner] Proj: l_quantity
[Planner] Forcing keep of global column: l_discount
[Planner] Forcing keep of global column: l_extendedprice
[Planner] Forcing keep of global column: p_size
[Planner] Forcing keep of global column: p_container
[Planner] Forcing keep of global column: p_brand
[Planner] Forcing keep of global column: p_partkey
[Planner] Node PROJECTION output projections: l_partkey, l_quantity, 
[Planner] Parsing Projections for PROJECTION
[Planner] Proj: (l_extendedprice * (1.00 - l_discount))
[Planner] Forcing keep of global column: l_quantity
[Planner] Forcing keep of global column: l_partkey
[Planner] Node PROJECTION output projections: (l_extendedprice * (1.00 - l_discount)), 
[Planner] Processing aggregate: 'sum((l_extendedprice * (1.00 - l_discount)))'
[Planner] Node UNGROUPED_AGGREGATE output projections: sum((l_extendedprice * (1.00 - l_discount))), 
[Main] Using GpuExecutor generic executor.
[GPU] Device: Apple M3 Ultra
[GPU] Pre-compiled metallib not found, compiling shaders at runtime...
[GPU] Runtime Metal shader compilation succeeded (123 KB source).
GpuOps::gatherU32: Input or Indices buffer is NULL
---------------------------------------------------
======================RESULT=======================
---------------------------------------------------
Scalar sum((l_extendedprice * (1.00 - l_discount))): 3083843.25
---------------------------------------------------
Planning time: 20.53 ms
Data Load Time (Disk+Upload): 17799.55 ms
GPU kernels time: 49.58 ms
CPU postprocess time: 433.58 ms
Total Internal Pipeline time: 18282.71 ms
Total Host Execution time: 18283.42 ms
Total Wall time (Plan+Exec): 18303.94 ms
---------------------------------------------------
GPU Kernel Timing Summary:
─────────────────────────────────────────
  compact        :   13.030 ms (26.281%) [28 calls]
  filter         :   27.220 ms (54.899%) [28 calls]
  gather         :    3.860 ms (7.786%) [17 calls]
  hash_join_probe_u32:    5.471 ms (11.035%) [18 calls]
─────────────────────────────────────────
  TOTAL GPU TIME: 49.582 ms
  Kernel invocations: 91
Detailed Kernel Timings:
─────────────────────────────────────────────────────────────────
Kernel                           Time (ms)       Elements           ME/s
─────────────────────────────────────────────────────────────────
ops::filter_string_eq                8.612        6001215        696.881
ops::compact_indices                 1.130        6001215       5311.985
ops::filter_string_eq                1.964        6001215       3055.414
ops::compact_indices                 1.322        6001215       4537.925
ops::filter_string_eq                2.847        6001215       2108.248
ops::compact_indices                 1.515        6001215       3961.959
hash_join_probe_write_multi          1.037        1500048       1446.119
ops::gather_col_u32                  0.271         214377        790.088
ops::filter_string_eq                1.771        6001215       3388.205
ops::compact_indices                 1.393        6001215       4306.577
hash_join_probe_write_multi          0.931         858104        921.537
ops::gather_col_u32                  0.843         214377        254.290
ops::filter_string_eq                2.054        6001215       2922.077
ops::compact_indices                 1.912        6001215       3138.643
hash_join_probe_write_multi          0.280         200000        714.817
ops::filter_le_f32                   2.458         214377         87.220
ops::compact_indices                 0.809         214377        265.100
ops::filter_le_u32_indexed           0.228          47244        206.907
ops::compact_indices_indexed         0.240          47244        197.090
ops::filter_string_eq                0.289         214377        742.215
ops::compact_indices                 0.255         214377        841.106
hash_join_probe_write_multi          0.237           8725         36.853
ops::gather_col_u32                  0.210            181          0.863
ops::filter_string_eq                0.265         214377        807.699
ops::compact_indices                 0.243         214377        882.515
hash_join_probe_write_multi          0.228           5121         22.493
ops::gather_col_u32                  0.197              5          0.025
ops::filter_string_eq                0.936         214377        229.147
ops::compact_indices                 0.256         214377        836.048
hash_join_probe_write_multi          0.217           5563         25.690
ops::gather_col_u32                  0.194              5          0.026
ops::filter_string_eq                0.342         214377        626.072
ops::compact_indices                 0.246         214377        872.931
hash_join_probe_write_multi          0.239           5387         22.508
ops::gather_col_u32                  0.197              8          0.041
ops::filter_string_eq                0.357         214377        600.076
ops::compact_indices                 0.269         214377        796.816
hash_join_probe_write_multi          0.230           5324         23.102
ops::gather_col_u32                  0.195              7          0.036
ops::filter_ge_f32                   0.240         214377        891.380
ops::compact_indices                 0.245         214377        876.049
ops::filter_le_f32_indexed           0.234         175772        751.831
ops::compact_indices_indexed         0.237         175772        741.654
ops::filter_le_u32_indexed           0.439          46782        106.524
ops::compact_indices_indexed         0.226          46782        206.619
ops::filter_string_eq                0.268         214377        798.671
ops::compact_indices                 0.243         214377        883.271
hash_join_probe_write_multi          0.231           8537         37.003
ops::gather_col_u32                  0.204            422          2.065
ops::filter_string_eq                1.460         214377        146.817
ops::compact_indices                 0.242         214377        887.076
hash_join_probe_write_multi          0.232           5438         23.457
ops::gather_col_u32                  0.182              6          0.033
ops::filter_string_eq                0.258         214377        831.857
ops::compact_indices                 0.240         214377        892.152
hash_join_probe_write_multi          0.245           5499         22.460
ops::gather_col_u32                  0.195             10          0.051
ops::filter_string_eq                0.235         214377        912.565
ops::compact_indices                 0.203         214377       1056.044
hash_join_probe_write_multi          0.205           5395         26.344
ops::gather_col_u32                  0.163             12          0.073
ops::filter_string_eq                0.231         214377        928.208
ops::compact_indices                 0.207         214377       1034.388
hash_join_probe_write_multi          0.190           5233         27.548
ops::gather_col_u32                  0.160             12          0.075
ops::filter_ge_f32                   0.198         214377       1080.665
ops::compact_indices                 0.204         214377       1052.157
ops::filter_le_f32_indexed           0.206         133273        647.610
ops::compact_indices_indexed         0.196         133273        681.125
ops::filter_le_u32_indexed           0.183          47267        258.466
ops::compact_indices_indexed         0.184          47267        256.943
ops::filter_string_eq                0.238         214377        900.430
ops::compact_indices                 0.205         214377       1047.018
hash_join_probe_write_multi          0.202           8534         42.195
ops::gather_col_u32                  0.179            542          3.027
ops::filter_string_eq                0.233         214377        920.895
ops::compact_indices                 0.205         214377       1047.233
hash_join_probe_write_multi          0.189           5326         28.211
ops::gather_col_u32                  0.170             15          0.088
ops::filter_string_eq                0.226         214377        949.621
ops::compact_indices                 0.201         214377       1066.775
hash_join_probe_write_multi          0.202           5579         27.625
ops::gather_col_u32                  0.172             11          0.064
ops::filter_string_eq                0.219         214377        980.569
ops::compact_indices                 0.201         214377       1067.439
hash_join_probe_write_multi          0.194           5404         27.826
ops::gather_col_u32                  0.167             11          0.066
ops::filter_string_eq                0.229         214377        935.972
ops::compact_indices                 0.203         214377       1056.044
hash_join_probe_write_multi          0.183           5265         28.803
ops::gather_col_u32                  0.161             19          0.118
─────────────────────────────────────────────────────────────────
TOTAL: 49.582 ms
