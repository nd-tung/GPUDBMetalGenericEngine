--- Running (Engine Host) ---
[Planner] Parsed aliases:
[Planner]   'count(*)' -> 'count_order'
[Planner]   'avg_price' -> 'avg(l_extendedprice)'
[Planner]   'sum(l_quantity)' -> 'sum_qty'
[Planner]   'avg_qty' -> 'avg(l_quantity)'
[Planner]   'avg(l_quantity)' -> 'avg_qty'
[Planner]   'sum_charge' -> 'sum(l_extendedprice * (1 - l_discount) * (1 + l_tax))'
[Planner]   'sum(l_extendedprice*(1-l_discount)*(1+l_tax))' -> 'sum_charge'
[Planner]   'sum_base_price' -> 'sum(l_extendedprice)'
[Planner]   'count_order' -> 'count(*)'
[Planner]   'sum(l_extendedprice)' -> 'sum_base_price'
[Planner]   'avg(l_extendedprice)' -> 'avg_price'
[Planner]   'avg(l_discount)' -> 'avg_disc'
[Planner]   'sum_qty' -> 'sum(l_quantity)'
[Planner]   'sum_disc_price' -> 'sum(l_extendedprice * (1 - l_discount))'
[Planner]   'avg_disc' -> 'avg(l_discount)'
[Planner]   'sum(l_extendedprice*(1-l_discount))' -> 'sum_disc_price'
[Planner] Traversing node: PROJECTION
[Planner] Traversing: PROJECTION
[Planner] Entering children traversal block. Name: projection Children: 1
[Planner] Traversing node: ORDER_BY
[Planner] Traversing: ORDER_BY
[Planner] Entering children traversal block. Name: order_by Children: 1
[Planner] Traversing node: PROJECTION
[Planner] Traversing: PROJECTION
[Planner] Entering children traversal block. Name: projection Children: 1
[Planner] Traversing node: PROJECTION
[Planner] Traversing: PROJECTION
[Planner] Entering children traversal block. Name: projection Children: 1
[Planner] Traversing node: PERFECT_HASH_GROUP_BY
[Planner] Traversing: PERFECT_HASH_GROUP_BY
[Planner] Entering children traversal block. Name: perfect_hash_group_by Children: 1
[Planner] Traversing node: PROJECTION
[Planner] Traversing: PROJECTION
[Planner] Entering children traversal block. Name: projection Children: 1
[Planner] Traversing node: PROJECTION
[Planner] Traversing: PROJECTION
[Planner] Entering children traversal block. Name: projection Children: 1
[Planner] Traversing node: PROJECTION
[Planner] Traversing: PROJECTION
[Planner] Entering children traversal block. Name: projection Children: 1
[Planner] Traversing node: SEQ_SCAN 
[Planner] Traversing: SEQ_SCAN 
[Planner] Entering children traversal block. Name: seq_scan  Children: 0
[Planner] Parsing Projections for SEQ_SCAN 
[Planner] Proj: l_returnflag
[Planner] Proj: l_linestatus
[Planner] Proj: l_quantity
[Planner] Proj: l_extendedprice
[Planner] Proj: l_discount
[Planner] Proj: l_tax
DEBUG: Scan table determined as: 'lineitem'
DEBUG: Pushing SCAN node for SEQ_SCAN . Table=lineitem
[Planner] Generating Scan: lineitem at index 0 Plan: 6168127768
[Planner] Node SEQ_SCAN  output projections: l_returnflag, l_linestatus, l_quantity, l_extendedprice, l_discount, l_tax, 
[Planner] Parsing Projections for PROJECTION
[Planner] Proj: l_returnflag
[Planner] Proj: l_linestatus
[Planner] Proj: l_quantity
[Planner] Proj: l_extendedprice
[Planner] Proj: (l_extendedprice * (1.00 - l_discount))
[Planner] Proj: l_tax
[Planner] Proj: l_discount
[Planner] Node PROJECTION output projections: l_returnflag, l_linestatus, l_quantity, l_extendedprice, (l_extendedprice * (1.00 - l_discount)), l_tax, l_discount, 
[Planner] Parsing Projections for PROJECTION
[Planner] Proj: l_returnflag
[Planner] Proj: l_linestatus
[Planner] Proj: l_quantity
[Planner] Proj: l_extendedprice
[Planner] Proj: (l_extendedprice * (1.00 - l_discount))
[Planner] Proj: l_tax
[Planner] Proj: l_discount
[Planner] Node PROJECTION output projections: l_returnflag, l_linestatus, l_quantity, l_extendedprice, (l_extendedprice * (1.00 - l_discount)), l_tax, l_discount, 
[Planner] Parsing Projections for PROJECTION
[Planner] Proj: l_returnflag
[Planner] Proj: l_linestatus
[Planner] Proj: l_quantity
[Planner] Proj: l_extendedprice
[Planner] Proj: (l_extendedprice * (1.00 - l_discount))
[Planner] Proj: ((l_extendedprice * (1.00 - l_discount)) * (1.00 + l_tax))
[Planner] Proj: l_quantity
[Planner] Proj: l_extendedprice
[Planner] Proj: l_discount
[Planner] Forcing keep of global column: l_tax
[Planner] Node PROJECTION output projections: l_returnflag, l_linestatus, l_quantity, l_extendedprice, (l_extendedprice * (1.00 - l_discount)), ((l_extendedprice * (1.00 - l_discount)) * (1.00 + l_tax)), l_quantity, l_extendedprice, l_discount, 
[Planner] Parsing agg string: 'sum_no_overflow(#2)'
[Planner] Resolved agg: sum_no_overflow(l_quantity)
[Planner] inputExpr 'l_quantity' exists in child projections. Treating as Column.
[Planner] Looking up agg alias: 'sum(l_quantity)'
[Planner] Found alias for agg: sum_qty
[Planner] Pushing spec with outputName='sum_qty'
[Planner] Parsing agg string: 'sum_no_overflow(#3)'
[Planner] Resolved agg: sum_no_overflow(l_extendedprice)
[Planner] inputExpr 'l_extendedprice' exists in child projections. Treating as Column.
[Planner] Looking up agg alias: 'sum(l_extendedprice)'
[Planner] Found alias for agg: sum_base_price
[Planner] Pushing spec with outputName='sum_base_price'
[Planner] Parsing agg string: 'sum_no_overflow(#4)'
[Planner] Resolved agg: sum_no_overflow((l_extendedprice * (1.00 - l_discount)))
[Planner] inputExpr '(l_extendedprice * (1.00 - l_discount))' exists in child projections. Treating as Column.
[Planner] Looking up agg alias: 'sum((l_extendedprice*(1-l_discount)))'
[Planner] Found alias with reduced parens: 'sum(l_extendedprice*(1-l_discount))'
[Planner] Found alias for agg: sum_disc_price
[Planner] Pushing spec with outputName='sum_disc_price'
[Planner] Parsing agg string: 'sum_no_overflow(#5)'
[Planner] Resolved agg: sum_no_overflow(((l_extendedprice * (1.00 - l_discount)) * (1.00 + l_tax)))
[Planner] inputExpr '((l_extendedprice * (1.00 - l_discount)) * (1.00 + l_tax))' exists in child projections. Treating as Column.
[Planner] Looking up agg alias: 'sum(((l_extendedprice*(1-l_discount))*(1+l_tax)))'
[Planner] Found alias via stripped comparison: 'sum_charge'
[Planner] Found alias for agg: sum_charge
[Planner] Pushing spec with outputName='sum_charge'
[Planner] Parsing agg string: 'avg(#6)'
[Planner] Resolved agg: avg(l_quantity)
[Planner] inputExpr 'l_quantity' exists in child projections. Treating as Column.
[Planner] Looking up agg alias: 'avg(l_quantity)'
[Planner] Found alias for agg: avg_qty
[Planner] Pushing spec with outputName='avg_qty'
[Planner] Parsing agg string: 'avg(#7)'
[Planner] Resolved agg: avg(l_extendedprice)
[Planner] inputExpr 'l_extendedprice' exists in child projections. Treating as Column.
[Planner] Looking up agg alias: 'avg(l_extendedprice)'
[Planner] Found alias for agg: avg_price
[Planner] Pushing spec with outputName='avg_price'
[Planner] Parsing agg string: 'avg(#8)'
[Planner] Resolved agg: avg(l_discount)
[Planner] inputExpr 'l_discount' exists in child projections. Treating as Column.
[Planner] Looking up agg alias: 'avg(l_discount)'
[Planner] Found alias for agg: avg_disc
[Planner] Pushing spec with outputName='avg_disc'
[Planner] Parsing agg string: 'count_star()'
[Planner] Resolved agg: count_star()
[Planner] Looking up agg alias: 'count_star()'
[Planner] Found alias for agg: count_order
[Planner] Pushing spec with outputName='count_order'
[Planner] Node PERFECT_HASH_GROUP_BY output projections: l_returnflag, l_linestatus, sum_qty, sum_base_price, sum_disc_price, sum_charge, avg_qty, avg_price, avg_disc, count_order, 
[Planner] Parsing Projections for PROJECTION
[Planner] Proj: l_returnflag
[Planner] Proj: l_linestatus
[Planner] Proj: sum_qty
[Planner] Proj: sum_base_price
[Planner] Proj: sum_disc_price
[Planner] Proj: sum_charge
[Planner] Proj: avg_qty
[Planner] Proj: avg_price
[Planner] Proj: avg_disc
[Planner] Proj: count_order
[Planner] Node PROJECTION output projections: l_returnflag, l_linestatus, sum_qty, sum_base_price, sum_disc_price, sum_charge, avg_qty, avg_price, avg_disc, count_order, 
[Planner] Parsing Projections for PROJECTION
[Planner] Proj: l_returnflag
[Planner] Proj: l_linestatus
[Planner] Proj: sum_qty
[Planner] Proj: sum_base_price
[Planner] Proj: sum_disc_price
[Planner] Proj: sum_charge
[Planner] Proj: avg_qty
[Planner] Proj: avg_price
[Planner] Proj: avg_disc
[Planner] Proj: count_order
[Planner] Node PROJECTION output projections: l_returnflag, l_linestatus, sum_qty, sum_base_price, sum_disc_price, sum_charge, avg_qty, avg_price, avg_disc, count_order, 
[Planner] Node ORDER_BY output projections: l_returnflag, l_linestatus, sum_qty, sum_base_price, sum_disc_price, sum_charge, avg_qty, avg_price, avg_disc, count_order, 
[Planner] Parsing Projections for PROJECTION
[Planner] Proj: l_returnflag
[Planner] Proj: l_linestatus
[Planner] Proj: sum_qty
[Planner] Proj: sum_base_price
[Planner] Proj: sum_disc_price
[Planner] Proj: sum_charge
[Planner] Proj: avg_qty
[Planner] Proj: avg_price
[Planner] Proj: avg_disc
[Planner] Proj: count_order
[Planner] Node PROJECTION output projections: l_returnflag, l_linestatus, sum_qty, sum_base_price, sum_disc_price, sum_charge, avg_qty, avg_price, avg_disc, count_order, 
[Main] Using GpuExecutor generic executor.
[GPU] Device: Apple M3 Ultra
[GPU] Pre-compiled metallib not found, compiling shaders at runtime...
[GPU] Runtime Metal shader compilation succeeded (123 KB source).
---------------------------------------------------
======================RESULT=======================
---------------------------------------------------
l_returnflag|l_linestatus|sum_qty|sum_base_price|sum_disc_price|sum_charge|avg_qty|avg_price|avg_disc|count_order|
A|F|37733868.00|56586240000.00|53757890560.00|55909257216.00|25.52|38272.94|0.05|1478493.00|
N|F|991417.00|1487504384.00|1413083008.00|1469651712.00|25.52|38284.46|0.05|38854.00|
N|O|74475912.00|111701704704.00|106116964352.00|110367842304.00|25.50|38249.09|0.05|2920374.00|
R|F|37719696.00|56568590336.00|53741682688.00|55889895424.00|25.51|38251.20|0.05|1478870.00|
---------------------------------------------------
Planning time: 44.43 ms
Data Load Time (Disk+Upload): 14584.45 ms
GPU kernels time: 300.21 ms
CPU postprocess time: 430.69 ms
Total Internal Pipeline time: 15315.36 ms
Total Host Execution time: 15315.43 ms
Total Wall time (Plan+Exec): 15359.86 ms
---------------------------------------------------
GPU Kernel Timing Summary:
─────────────────────────────────────────
  compact        :    1.340 ms (0.446%) [1 calls]
  filter         :    6.873 ms (2.289%) [1 calls]
  gather         :   19.975 ms (6.654%) [11 calls]
  groupby        :  272.025 ms (90.611%) [1 calls]
  sort           :    0.000 ms (0.000%) [1 calls]
─────────────────────────────────────────
  TOTAL GPU TIME: 300.213 ms
  Kernel invocations: 15
Detailed Kernel Timings:
─────────────────────────────────────────────────────────────────
Kernel                           Time (ms)       Elements           ME/s
─────────────────────────────────────────────────────────────────
ops::filter_le_u32                   6.873        6001215        873.121
ops::compact_indices                 1.340        6001215       4477.546
ops::gather_col_u32                  1.241        5916591       4765.998
ops::gather_col_u32                  1.362        5916591       4345.377
ops::gather_col_f32                  1.920        5916591       3081.291
ops::gather_col_f32                  2.130        5916591       2777.363
ops::gather_col_f32                  1.636        5916591       3617.327
ops::gather_col_f32                  3.280        5916591       1804.068
ops::gather_col_f32                  1.726        5916591       3427.093
ops::gather_col_f32                  1.666        5916591       3551.729
ops::gather_col_f32                  1.779        5916591       3325.018
ops::gather_col_f32                  1.534        5916591       3858.121
ops::gather_col_f32                  1.701        5916591       3478.130
ops::groupby_agg_multi_key_ty      272.025        5916591         21.750
block_sort_kv_u64                    0.000              4          0.000
─────────────────────────────────────────────────────────────────
TOTAL: 300.213 ms
